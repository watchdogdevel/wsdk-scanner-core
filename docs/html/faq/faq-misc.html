<!DOCTYPE HTML>
<html lang="en" class="clamav sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Misc - ClamAV Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="An open source malware detection toolkit and antivirus engine.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "clamav";
            const default_dark_theme = "clamav";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('clamav')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="clamav">Dark</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="clamav_light">Light</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ClamAV Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="miscellaneous-faq"><a class="header" href="#miscellaneous-faq">Miscellaneous FAQ</a></h1>
<p>If you're unable to find an answer to your question in our FAQ, you can seek help in <a href="https://www.clamav.net/contact.html#ml">our clamav-users mailing list</a>, on our <a href="https://discord.gg/6vNAqWnVgw">Discord server</a>, or by submitting an <a href="https://github.com/Cisco-Talos/clamav/issues">issue on GitHub</a>. The mailing list archives and existing Github issues (open or closed) may also have an answer to your question.</p>
<p>Please consider contributing answered questions back to this FAQ, and improving the quality of these answers, by submitting pull requests to <a href="https://github.com/Cisco-Talos/clamav-documentation">our documentation source repository</a>.</p>
<h2 id="where-can-i-find-the-bug-ticket-for-a-security-bug-fix"><a class="header" href="#where-can-i-find-the-bug-ticket-for-a-security-bug-fix">Where can I find the bug ticket for a security bug fix?</a></h2>
<p>Our policy is to make security-related bugs public either:
A. fourteen (14) days after a security patch version has been published with a fix for the bug, or
B. after the non-disclosure agreement with a vulnerability reporter has expired and the bug details are otherwise already public.</p>
<p>This policy serves to reduce the risk that a malicious party would find enough details in the ticket to craft their own exploit for the bug before users have had an opportunity to upgrade to a patched version.</p>
<h2 id="where-can-i-find-a-test-file-to-prove-that-a-security-bug-doesnt-affect-me-or-has-been-fixed-in-my-version"><a class="header" href="#where-can-i-find-a-test-file-to-prove-that-a-security-bug-doesnt-affect-me-or-has-been-fixed-in-my-version">Where can I find a test file to prove that a security bug doesn't affect me or has been fixed in my version?</a></h2>
<p>We do not share test files for security bugs. Sharing these files puts users at risk for at least two reasons:</p>
<ol>
<li>Sharing a test file outside of our organization increases the risk of it falling into the wrong hands and being used to craft an exploit.</li>
<li>Test files generated by a fuzzer are designed to demonstrate a bug in a specific test environment and do the bare minimum necessary to trigger the bug. Scanning a test file outside of that environment is unlikely to demonstrate the issue EVEN THOUGH THE ISSUE STILL EXISTS. A clever adversary may very well be able to craft a bigger and better exploit for that issue that does affect your unpatched system. Testing with the original fuzzer-generated file is most likely to give you a false sense of security.</li>
</ol>
<h2 id="can-phishing-be-considered-one-kind-of-spam-clamav-should-not-detect-it-as-some-kind-of-malware"><a class="header" href="#can-phishing-be-considered-one-kind-of-spam-clamav-should-not-detect-it-as-some-kind-of-malware">Can phishing be considered one kind of spam? ClamAV should not detect it as some kind of malware.</a></h2>
<p>Starting from release 0.90, ClamAV allows you to choose whether to detect phish as some kind of malware or not. This should put an end to the endless threads on our mailing lists. So long, and thanks for all the phish.</p>
<h2 id="why-is-my-legitimate-html-newsletteremail-detected-by-clamav-as-phishingheuristicsemailspoofeddomain"><a class="header" href="#why-is-my-legitimate-html-newsletteremail-detected-by-clamav-as-phishingheuristicsemailspoofeddomain">Why is my legitimate HTML newsletter/email detected by ClamAV as Phishing.Heuristics.Email.SpoofedDomain?</a></h2>
<p>If it contains links in the form of <code>href="http://yourdomain.example.tld"&gt; otherdomain.tld</code>, where <code>otherdomain.tld</code> (ProtectedDomain) doesn't belong to you and is listed in ClamAV database (like amazon.com, ebay.com, ...) then ClamAV detects it as a phishing attempt.</p>
<h2 id="my-legitimate-emails-from-yourdomaintld-are-detected-as-phishingheuristicsemailspoofeddomain"><a class="header" href="#my-legitimate-emails-from-yourdomaintld-are-detected-as-phishingheuristicsemailspoofeddomain">My legitimate emails from yourdomain.tld are detected as Phishing.Heuristics.Email.SpoofedDomain</a></h2>
<p>Please <a href="https://www.clamav.net/reports/malware">submit a sample</a>, marking it as a false positive, phishing. If it's really a false positive, we will add an allow list entry for it.</p>
<h2 id="can-i-convert-the-new-database-format-to-the-old-one"><a class="header" href="#can-i-convert-the-new-database-format-to-the-old-one">Can I convert the new database format to the old one?</a></h2>
<p>Yes, install a recent version of sigtool and run:</p>
<p><code>sigtool --unpack-current daily.cvd; sigtool --unpack-current main.cvd</code></p>
<h2 id="how-do-i-read-inside-the-cvd-files"><a class="header" href="#how-do-i-read-inside-the-cvd-files">How do I read inside the CVD files?</a></h2>
<p>See previous FAQ.</p>
<h2 id="im-using-clamav-in-a-production-environment-and-a-brand-new-virus-is-not-being-recognized-by-clamav-how-long-do-i-have-to-wait-before-clamav-can-start-filtering-the-virus"><a class="header" href="#im-using-clamav-in-a-production-environment-and-a-brand-new-virus-is-not-being-recognized-by-clamav-how-long-do-i-have-to-wait-before-clamav-can-start-filtering-the-virus">I'm using ClamAV in a production environment and a brand new virus is not being recognized by ClamAV. How long do I have to wait before ClamAV can start filtering the virus?</a></h2>
<p>No time at all! Find a signature for that virus and modify your virus database accordingly (see our <a href="../manual/Signatures.html">signature writing documentation</a> for details).
Remember to <a href="https://www.clamav.net/reports/malware">submit</a> the sample to the virusdb team.</p>
<h2 id="why-is-clamav-calling-the-xxx-virus-with-another-name"><a class="header" href="#why-is-clamav-calling-the-xxx-virus-with-another-name">Why is ClamAV calling the XXX virus with another name?</a></h2>
<p>This usually happens when we add a signature <em>before</em> other AV vendors. No well-known name is available at that moment so we have to invent one. Renaming the virus after a few days would just confuse people more, so we usually keep on using our name for that virus. The only exception is when a new name is established soon after the signature addition.</p>
<h2 id="i-get-many-false-positives-of-oversizedzip"><a class="header" href="#i-get-many-false-positives-of-oversizedzip">I get many false positives of Oversized.zip</a></h2>
<p>Whenever a file exceeds ArchiveMaxCompressionRatio (see <code>clamd.conf</code> man page), it's considered a logic bomb and marked as <code>Oversized.zip</code>. Try increasing your ArchiveMaxCompressionRatio setting.</p>
<h2 id="what-is-pua-i-get-a-lot-of-false-positives-named-pua"><a class="header" href="#what-is-pua-i-get-a-lot-of-false-positives-named-pua">What is PUA? I get a lot of false positives named PUA.</a></h2>
<p>With the release of ClamAV 0.91.2 we introduce the option to scan for Potentially Unwanted Applications.</p>
<p>The PUA database contains detection for applications that are not malicious by itself but can be used in a malicious or unwanted context. As an example: A tool to retrieve passwords from a system can be useful as long as the person who uses it, is authorized to do so. However, the same tool can be used to steal passwords from a system. To make use of the PUA database you can use the <strong><code>--detect-pua</code> switch</strong> for clamscan or enable it in the config file for ClamD (add: <code>DetectPUA yes</code>).</p>
<p>At this point we DO NOT recommend using it in production environments, because the detection may be too aggressive and lead to false positives. In one of the next releases we will provide additional features for fine-tuning allowing better adjustments to different setups. NOTE: A detection as PUA does NOT tell if an application is good or bad. All it says is, that a file MAY BE unwanted or MAYBE could compromise your system security and it MAY BE a good idea to check it twice.</p>
<h2 id="can-clamav-disinfect-files"><a class="header" href="#can-clamav-disinfect-files">Can ClamAV disinfect files?</a></h2>
<p>No, it can't. We will add support for disinfecting OLE2 files in one of the next stable releases. There are no plans for disinfecting other types of files. There are many reasons for it: cleaning viruses from files is virtually pointless these days. It is very seldom that there is anything useful left after cleaning, and even if there is, would you trust it?</p>
<h2 id="when-using-clamscan-is-there-a-way-to-know-which-message-within-an-mbox-is-infected"><a class="header" href="#when-using-clamscan-is-there-a-way-to-know-which-message-within-an-mbox-is-infected">When using clamscan, is there a way to know which message within an mbox is infected?</a></h2>
<p>There are two solutions: Run <code>clamscan --debug</code>, look for <em>Deal with email number xxx</em> Alternatively you can convert the mbox to Maildir format, run clamscan on it and then convert it back to mbox format. There are many tools available which can convert to and from Maildir format: formail, mbox2maildir and maildir2mbox</p>
<h2 id="what-platforms-does-it-support"><a class="header" href="#what-platforms-does-it-support">What platforms does it support?</a></h2>
<p>Clam AntiVirus works with LinuxÂ®, Solaris, FreeBSD, OpenBSD, NetBSD, Mac OS X, Cygwin B20 on multiple architectures such as Intel, Alpha, Sparc, Cobalt MIPS boxes, PowerPC, RISC 6000.</p>
<h2 id="where-can-i-find-more-information-about-clamav"><a class="header" href="#where-can-i-find-more-information-about-clamav">Where can I find more information about ClamAV?</a></h2>
<p>Please read the complete documentation in pdf/ps format. You will find it inside the package or in the <a href="https://www.clamav.net/manual/installing.md">documentation</a> section of this website. You can also try searching the <a href="https://www.clamav.net/contact#ml">mailing list archives</a>. If you can't find the answer, you can ask for support on the clamav-users mailing-list, but <em>please</em> before doing it, search the archives! Also, make sure that you don't send HTML messages and that you don't top post: these violate the netiquette and lessen your chances of being answered.</p>
<h2 id="what-is-the-difference-between-scanning-with-clamscan-versus-scanning-with-clamd"><a class="header" href="#what-is-the-difference-between-scanning-with-clamscan-versus-scanning-with-clamd">What is the difference between scanning with <code>clamscan</code> versus scanning with <code>clamd</code>?</a></h2>
<p><code>clamscan</code> is a program that you run to scan a specific file or directory. It will load in the signature set, run the scan and output the results, and then exit. There are some command line options to customize the behavior, but it does not use a config file. Note that <code>clamdscan</code> and <code>clamscan</code> have very similar names but are different.</p>
<p><code>clamd</code> is a service process that you start and leave up. There is a <code>clamd.conf</code> config file that you must set up to customize how <code>clamd</code> works. Once <code>clamd</code> is running, you can send scan requests to it over a socket -- either a TCP network socket, or a local unix socket (you select which socket it listens to by editing the config file <em>before</em> you start <code>clamd</code>). <code>clamd</code> will send the response back to whatever program issued the scan request. It will also log the scan results itself, but that may not be as useful as collecting the results from the program that sent the request.</p>
<p>We provide 3 different programs to send scan requests to <code>clamd</code>:</p>
<ul>
<li><code>clamdscan</code>: <code>clamdscan</code> has an interface similar to <code>clamscan</code> and is for scanning a specific file or directory.</li>
<li><code>clamav-milter</code>: <code>clamav-milter</code> is for use with Sendmail. You can set up Sendmail to send attachments to <code>clamav-milter</code> to be filtered. It will in turn send them to <code>clamd</code> for scanning, and then send the scan result back to <code>sendmail</code>.</li>
<li><code>clamonacc</code>: <code>clamonacc</code> is another service program. You start <code>clamonacc</code> as root and it will register with the linux kernel to receive file-access events for specific directories. You can configure <code>clamonacc</code> in <code>clamd.conf</code>. When a file access event occurs, <code>clamonacc</code> will send the given file to <code>clamd</code> to be scanned. You can set it up so the kernel will block access to the file until the scan result comes back clean, but that may have a severe impact on user experience or even system performance depending on which directories you ask it to monitor.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../faq/faq-malware-fp-reports.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../faq/faq-ml.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../faq/faq-malware-fp-reports.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../faq/faq-ml.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
