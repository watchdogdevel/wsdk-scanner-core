<!DOCTYPE HTML>
<html lang="en" class="clamav sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Troubleshooting - ClamAV Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="An open source malware detection toolkit and antivirus engine.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "clamav";
            const default_dark_theme = "clamav";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('clamav')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="clamav">Dark</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="clamav_light">Light</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ClamAV Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="troubleshooting-faq"><a class="header" href="#troubleshooting-faq">Troubleshooting FAQ</a></h1>
<p>The following questions and answers may help you troubleshoot issues you may encounter when using ClamAV.</p>
<p>If you're unable to find an answer to your question in our FAQ, you can seek help in <a href="https://www.clamav.net/contact.html#ml">our clamav-users mailing list</a>, on our <a href="https://discord.gg/6vNAqWnVgw">Discord server</a>, or by submitting an <a href="https://github.com/Cisco-Talos/clamav/issues">issue on GitHub</a>. The mailing list archives and existing Github issues (open or closed) may also have an answer to your question.</p>
<p>Please consider contributing answered questions back to this FAQ, and improving the quality of these answers, by submitting pull requests to <a href="https://github.com/Cisco-Talos/clamav-documentation">our documentation source repository</a>.</p>
<h2 id="after-clamav-is-installed-then-what-how-do-i-update--refresh-the-virus-database"><a class="header" href="#after-clamav-is-installed-then-what-how-do-i-update--refresh-the-virus-database">After ClamAV is installed, then what? How do I update / refresh the virus database?</a></h2>
<p>You will need to edit the <code>freshclam.conf.example</code> file located in <code>/usr/local/etc</code>. Once that is done, you will need to run a <code>sudo freshclam</code> to download the signatures. You will need to run the command to update signatures often so that ClamAV has the most up to date signatures.</p>
<h2 id="how-many-times-per-hour-shall-i-run-freshclam"><a class="header" href="#how-many-times-per-hour-shall-i-run-freshclam">How many times per hour shall I run FreshClam?</a></h2>
<p>You can check for database update as often as 4 times per hour provided that you have the following options in <code>freshclam.conf</code>:</p>
<pre><code class="language-ini">DNSDatabaseInfo current.cvd.clamav.net

DatabaseMirror database.clamav.net
</code></pre>
<h2 id="i-get-this-error-when-running-freshclam-invalid-dns-reply-falling-back-to-http-mode-or-error-cant-query-currentcvdclamavnet--what-does-it-mean"><a class="header" href="#i-get-this-error-when-running-freshclam-invalid-dns-reply-falling-back-to-http-mode-or-error-cant-query-currentcvdclamavnet--what-does-it-mean">I get this error when running FreshClam: <em>Invalid DNS reply. Falling back to HTTP mode</em> or <em>ERROR: Can't query current.cvd.clamav.net</em> . What does it mean?</a></h2>
<p>There is a problem with your DNS server. Please check the entries in /etc/resolv.conf and verify that you can resolve the TXT record manually:</p>
<pre><code class="language-bash">host -t txt current.cvd.clamav.net
</code></pre>
<p>If you can't, it means your network is broken. You'll be still able to download the updates, but you'll waste a lot of bandwidth checking for updates.</p>
<h2 id="what-does-warning-dns-record-is-older-than-3-hours-mean"><a class="header" href="#what-does-warning-dns-record-is-older-than-3-hours-mean">What does <em>WARNING: DNS record is older than 3 hours</em> mean?</a></h2>
<p>FreshClam attempts to detect potential problems with DNS caches and switches to use HTTPS if something looks suspicious. If this message appears seldomly, you can safely ignore it. If you get the error every time you run FreshClam, check your system clock. If it is set correctly, check your dns settings. If those didn't help, try putting this at the top of your cronjob:</p>
<pre><code class="language-bash">host -t txt current.cvd.clamav.net; perl -e 'printf "%d\n", time;'
</code></pre>
<p>The 4th field of the first line should be less than 3 âˆ— 3600 behind the output of the second line. If not, you have a caching DNS server somewhere  misbehaving.</p>
<h2 id="i-get-this-error-when-running-freshclam-error-connection-with--failed--what-shall-i-do"><a class="header" href="#i-get-this-error-when-running-freshclam-error-connection-with--failed--what-shall-i-do">I get this error when running FreshClam: <em>ERROR: Connection with ??? failed</em> . What shall I do?</a></h2>
<p>Either your dns servers are not working or you are blocking port 53/tcp. You should manually check that you can resolve host names with:</p>
<pre><code class="language-bash">host database.clamav.net
</code></pre>
<p>If it doesn't work, check your dns settings in <code>/etc/resolv.conf</code>. If it works, check that you can receive dns answers longer than 512 bytes, e.g. check that your firewall is not blocking packets which originate from <code>port 53/tcp</code>.</p>
<p>An easy way to find it out is:</p>
<pre><code class="language-bash">dig @ns1.clamav.net db.us.big.clamav.net
</code></pre>
<h2 id="how-do-i-know-if-my-ip-address-has-been-blocked"><a class="header" href="#how-do-i-know-if-my-ip-address-has-been-blocked">How do I know if my IP address has been blocked?</a></h2>
<p>Run FreshClam in verbose-mode (<code>-v</code>) to view the HTTP requests and responses. If you're seeing an HTTP 403 response, then you may have been blocked. If think you've been blocked, feel free to contact us for help getting un-blocked. For more information about HTTP error codes, see the <a href="faq-freshclam.html">FreshClam FAQ</a></p>
<h2 id="i-cant-resolve-currentcvdclamavnet-is-there-a-problem-with-yourmy-dns-servers"><a class="header" href="#i-cant-resolve-currentcvdclamavnet-is-there-a-problem-with-yourmy-dns-servers">I can't resolve <code>current.cvd.clamav.net</code>! Is there a problem with your/my DNS servers?</a></h2>
<p>current.cvd.clamav.net has got only a TXT record, not a type A record! Try this command:</p>
<pre><code class="language-bash">$ host -t txt current.cvd.clamav.net
</code></pre>
<p>Please note that some not RFC compliant DNS servers (namely the one shipped with the <em>Alcatel</em> (now <em>Thomson</em>) <strong>SpeedTouch 510 modem</strong>) can't resolve <code>TXT</code> record. If that's the case, please recompile ClamAV with the CMake option: <code>-D ENABLE_FRESHCLAM_DNS_FIX=ON</code></p>
<hr />
<p>For other questions regarding issues with the signature databases, see our <a href="faq-cvd.html">Virus Database FAQ</a>.</p>
<h2 id="clamav-becomes-unresponsive"><a class="header" href="#clamav-becomes-unresponsive">ClamAV becomes unresponsive</a></h2>
<p>ClamAV requires a lot of memory in order to function properly. It is particularly common in environments like Docker / Kubernetes for a container to lack the required memory needed for the <code>clamd</code> process to reload the databases after the daily signature update. This may cause the process to crash or become unresponsive. You can find <a href="../manual/Installing/Docker.html#memory-ram-requirements">more information here</a>.</p>
<h2 id="clamav-stops-responding-after-about-24-hours"><a class="header" href="#clamav-stops-responding-after-about-24-hours">ClamAV stops responding after about 24 hours</a></h2>
<p>ClamAV requires a lot of memory in order to function properly. It is particularly common in environments like Docker / Kubernetes for a container to lack the required memory needed for the <code>clamd</code> process to reload the databases after the daily signature update. This may cause the process to crash or become unresponsive. You can find <a href="../manual/Installing/Docker.html#memory-ram-requirements">more information here</a>.</p>
<h2 id="clamav-crashes-once-each-day"><a class="header" href="#clamav-crashes-once-each-day">ClamAV crashes once each day</a></h2>
<p>ClamAV requires a lot of memory in order to function properly. It is particularly common in environments like Docker / Kubernetes for a container to lack the required memory needed for the <code>clamd</code> process to reload the databases after the daily signature update. This may cause the process to crash or become unresponsive. You can find <a href="../manual/Installing/Docker.html#memory-ram-requirements">more information here</a>.</p>
<h2 id="clamav-build-fails-on-redhat-enterprise-linux-rhel-8-or-almalinux-8"><a class="header" href="#clamav-build-fails-on-redhat-enterprise-linux-rhel-8-or-almalinux-8">ClamAV build fails on RedHat Enterprise Linux (RHEL) 8, or AlmaLinux 8</a></h2>
<p>ClamAV version 1.5.0 and newer may fail to compile on RHEL 8 or AlmaLinux 8 with this error:</p>
<pre><code>../libclamav/libclamav.so.12.1.0: undefined reference to `json_object_new_uint64'
collect2: error: ld returned 1 exit status
make[2]: *** [clamconf/CMakeFiles/clamconf.dir/build.make:110: clamconf/clamconf] Error 1
make[1]: *** [CMakeFiles/Makefile2:1891: clamconf/CMakeFiles/clamconf.dir/all] Error 2
make: *** [Makefile:166: all] Error 2
</code></pre>
<p>This is a compatibility issue with ClamAV 1.5.0 and the older version of <code>libjson-c</code> provided by RedHat 8. It won't be fixed because the ClamAV development team only supports <a href="../Introduction.html#supported-platforms">the last two major versions</a> for popular operating systems.</p>
<p>You can work around this issue by:</p>
<ol>
<li>Compiling a newer version of libjson-c yourself.</li>
<li>Using the ClamAV project provided RPM to install ClamAV.</li>
<li>Upgrading to a newer version of RHEL or AlmaLinux.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../faq/faq-safebrowsing.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../faq/faq-scan-alerts.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../faq/faq-safebrowsing.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../faq/faq-scan-alerts.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
